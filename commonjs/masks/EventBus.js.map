{"version":3,"file":"EventBus.js","sourceRoot":"","sources":["../../src/masks/EventBus.ts"],"names":[],"mappings":";;;AAaA;IAAA;QACW,gBAAW,GAAG,IAAI,GAAG,EAAuC,CAAC;IAsBxE,CAAC;IApBC,4BAAS,GAAT,UAA+B,IAAO,EAAE,OAAoB;QAC1D,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;YAC/B,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,EAAE,IAAI,GAAG,EAAE,CAAC,CAAC;SACvC;QAED,IAAM,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAE,CAAC;QAC7C,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QAEtB,OAAO;YACL,QAAQ,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QAC3B,CAAC,CAAC;IACJ,CAAC;IAED,2BAAQ,GAAR,UAA8B,IAAO;QAAE,cAAgC;aAAhC,UAAgC,EAAhC,qBAAgC,EAAhC,IAAgC;YAAhC,6BAAgC;;QACrE,IAAM,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QAC5C,IAAI,QAAQ,EAAE;YACZ,kDAAkD;YAClD,QAAQ,CAAC,OAAO,CAAC,UAAA,OAAO,IAAI,OAAC,OAAsD,gCAAI,IAAI,IAA/D,CAAgE,CAAC,CAAC;SAC/F;IACH,CAAC;IACH,eAAC;AAAD,CAAC,AAvBD,IAuBC","sourcesContent":["import { Position } from '../common/types';\n\ninterface EventMap {\n  SELECT_CELL(cell: Position, openEditor?: boolean): void;\n  SELECT_START(selectedPosition: Position): void;\n  SELECT_UPDATE(cellPosition: Position, isFromKeyboard?: boolean, callback?: () => void): void;\n  SELECT_END(): void;\n  DRAG_ENTER(overRowIdx: number): void;\n  SCROLL_TO_COLUMN(idx: number): void;\n}\n\ntype EventName = keyof EventMap;\n\nexport default class EventBus {\n  readonly subscribers = new Map<EventName, Set<EventMap[EventName]>>();\n\n  subscribe<T extends EventName>(type: T, handler: EventMap[T]) {\n    if (!this.subscribers.has(type)) {\n      this.subscribers.set(type, new Set());\n    }\n\n    const handlers = this.subscribers.get(type)!;\n    handlers.add(handler);\n\n    return () => {\n      handlers.delete(handler);\n    };\n  }\n\n  dispatch<T extends EventName>(type: T, ...args: Parameters<EventMap[T]>) {\n    const handlers = this.subscribers.get(type);\n    if (handlers) {\n      // handler needed a type assertion to fix type bug\n      handlers.forEach(handler => (handler as (...args: Parameters<EventMap[T]>) => void)(...args));\n    }\n  }\n}\n"]}