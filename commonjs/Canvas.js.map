{"version":3,"file":"Canvas.js","sourceRoot":"","sources":["../src/Canvas.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\nimport { isElement } from 'react-is';\n\nimport Row from './Row';\nimport RowsContainerDefault from './RowsContainer';\nimport RowGroup from './RowGroup';\nimport { InteractionMasks } from './masks';\nimport * as rowUtils from './RowUtils';\nimport { getColumnScrollPosition } from './utils/canvasUtils';\nimport { EventTypes } from './common/enums';\nimport { CalculatedColumn, Position, ScrollPosition, SubRowDetails, RowRenderer, RowRendererProps, RowData } from './common/types';\nimport { ViewportProps, ViewportState } from './Viewport';\n\ntype SharedViewportProps<R> = Pick<ViewportProps<R>,\n'rowKey'\n| 'totalWidth'\n| 'rowGetter'\n| 'rowsCount'\n| 'selectedRows'\n| 'rowRenderer'\n| 'cellMetaData'\n| 'rowHeight'\n| 'scrollToRowIndex'\n| 'contextMenu'\n| 'rowSelection'\n| 'getSubRowDetails'\n| 'rowGroupRenderer'\n| 'enableCellSelect'\n| 'enableCellAutoFocus'\n| 'cellNavigationMode'\n| 'eventBus'\n| 'RowsContainer'\n| 'editorPortalTarget'\n| 'interactionMasksMetaData'\n>;\n\ntype SharedViewportState = Pick<ViewportState,\n'rowOverscanStartIdx'\n| 'rowOverscanEndIdx'\n| 'rowVisibleStartIdx'\n| 'rowVisibleEndIdx'\n| 'colVisibleStartIdx'\n| 'colVisibleEndIdx'\n| 'colOverscanStartIdx'\n| 'colOverscanEndIdx'\n| 'lastFrozenColumnIndex'\n| 'height'\n| 'isScrolling'\n>;\n\nexport interface CanvasProps<R> extends SharedViewportProps<R>, SharedViewportState {\n  columns: CalculatedColumn<R>[];\n  width: number;\n  totalColumnWidth: number;\n  onScroll(position: ScrollPosition): void;\n}\n\ntype RendererProps<R> = Pick<CanvasProps<R>, 'rowVisibleStartIdx' | 'rowVisibleEndIdx' | 'columns' | 'cellMetaData' | 'colVisibleStartIdx' | 'colVisibleEndIdx' | 'colOverscanEndIdx' | 'colOverscanStartIdx' | 'lastFrozenColumnIndex' | 'isScrolling'> & {\n  ref(row: (RowRenderer<R> & React.Component<RowRendererProps<R>>) | null): void;\n  key: number;\n  idx: number;\n  row: R;\n  subRowDetails?: SubRowDetails;\n  height: number;\n  isSelected: boolean;\n  scrollLeft: number;\n};\n\nexport default class Canvas<R> extends React.PureComponent<CanvasProps<R>> {\n  static displayName = 'Canvas';\n\n  private readonly canvas = React.createRef<HTMLDivElement>();\n  private readonly interactionMasks = React.createRef<InteractionMasks<R>>();\n  private readonly rows = new Map<number, RowRenderer<R> & React.Component<RowRendererProps<R>>>();\n  private unsubscribeScrollToColumn?(): void;\n  private _scroll = { scrollTop: 0, scrollLeft: 0 };\n\n  componentDidMount() {\n    this.unsubscribeScrollToColumn = this.props.eventBus.subscribe(EventTypes.SCROLL_TO_COLUMN, this.scrollToColumn);\n  }\n\n  componentWillUnmount() {\n    this.unsubscribeScrollToColumn!();\n  }\n\n  componentDidUpdate(prevProps: CanvasProps<R>) {\n    const { scrollToRowIndex } = this.props;\n    if (scrollToRowIndex && prevProps.scrollToRowIndex !== scrollToRowIndex) {\n      this.scrollToRow(scrollToRowIndex);\n    }\n  }\n\n  handleScroll = (e: React.UIEvent<HTMLDivElement>) => {\n    const { scrollLeft, scrollTop } = e.currentTarget;\n    this._scroll = { scrollTop, scrollLeft };\n    if (this.props.onScroll) {\n      this.props.onScroll(this._scroll);\n    }\n  };\n\n  onHitBottomCanvas = () => {\n    const { current } = this.canvas;\n    if (current) {\n      current.scrollTop += this.props.rowHeight + this.getClientScrollTopOffset(current);\n    }\n  };\n\n  onHitTopCanvas = () => {\n    const { current } = this.canvas;\n    if (current) {\n      current.scrollTop -= this.props.rowHeight - this.getClientScrollTopOffset(current);\n    }\n  };\n\n  handleHitColummBoundary = ({ idx }: Position) => {\n    this.scrollToColumn(idx);\n  };\n\n  scrollToRow(scrollToRowIndex: number) {\n    const { current } = this.canvas;\n    if (!current) return;\n    const { rowHeight, rowsCount, height } = this.props;\n    current.scrollTop = Math.min(\n      scrollToRowIndex * rowHeight,\n      rowsCount * rowHeight - height\n    );\n  }\n\n  scrollToColumn = (idx: number) => {\n    const { current } = this.canvas;\n    if (!current) return;\n\n    const { scrollLeft, clientWidth } = current;\n    const newScrollLeft = getColumnScrollPosition(this.props.columns, idx, scrollLeft, clientWidth);\n    if (newScrollLeft !== 0) {\n      current.scrollLeft = scrollLeft + newScrollLeft;\n    }\n  };\n\n  getRows(rowOverscanStartIdx: number, rowOverscanEndIdx: number) {\n    const rows = [];\n    let i = rowOverscanStartIdx;\n    while (i < rowOverscanEndIdx) {\n      const row = this.props.rowGetter(i);\n      let subRowDetails: SubRowDetails | undefined;\n      if (this.props.getSubRowDetails) {\n        subRowDetails = this.props.getSubRowDetails(row);\n      }\n      rows.push({ row, subRowDetails });\n      i++;\n    }\n    return rows;\n  }\n\n  getScroll() {\n    const { scrollTop, scrollLeft } = this.canvas.current!;\n    return { scrollTop, scrollLeft };\n  }\n\n  getClientScrollTopOffset(node: HTMLDivElement) {\n    const { rowHeight } = this.props;\n    const scrollVariation = node.scrollTop % rowHeight;\n    return scrollVariation > 0 ? rowHeight - scrollVariation : 0;\n  }\n\n  isRowSelected(idx: number, row: R) {\n    // Use selectedRows if set\n    if (this.props.selectedRows) {\n      const selectedRow = this.props.selectedRows.find(r => {\n        const rowKeyValue = rowUtils.get(row, this.props.rowKey);\n        return r[this.props.rowKey] === rowKeyValue;\n      });\n      return !!(selectedRow && selectedRow.isSelected);\n    }\n\n    // Else use new rowSelection props\n    if (this.props.rowSelection) {\n      const { keys, indexes, isSelectedKey } = this.props.rowSelection as { [key: string]: unknown };\n      return rowUtils.isRowSelected(keys as { rowKey?: string; values?: string[] } | null, indexes as number[] | null, isSelectedKey as string | null, row, idx);\n    }\n\n    return false;\n  }\n\n  setScrollLeft(scrollLeft: number) {\n    const { current } = this.interactionMasks;\n    if (current) {\n      current.setScrollLeft(scrollLeft);\n    }\n\n    this.rows.forEach((r, idx) => {\n      const row = this.getRowByRef(idx);\n      if (row && row.setScrollLeft) {\n        row.setScrollLeft(scrollLeft);\n      }\n    });\n  }\n\n  getRowByRef = (i: number) => {\n    // check if wrapped with React DND drop target\n    if (!this.rows.has(i)) return;\n\n    const row = this.rows.get(i)!;\n    const wrappedRow = row.getDecoratedComponentInstance ? row.getDecoratedComponentInstance(i) : null;\n    return wrappedRow ? wrappedRow.row : row;\n  };\n\n  getRowTop = (rowIdx: number) => {\n    const row = this.getRowByRef(rowIdx);\n    if (row && row.getRowTop) {\n      return row.getRowTop();\n    }\n    return this.props.rowHeight * rowIdx;\n  };\n\n  getRowHeight = (rowIdx: number) => {\n    const row = this.getRowByRef(rowIdx);\n    if (row && row.getRowHeight) {\n      return row.getRowHeight();\n    }\n    return this.props.rowHeight;\n  };\n\n  getRowColumns = (rowIdx: number) => {\n    const row = this.getRowByRef(rowIdx);\n    return row && row.props ? row.props.columns : this.props.columns;\n  };\n\n  renderCustomRowRenderer(props: RendererProps<R>) {\n    const { ref, ...otherProps } = props;\n    const CustomRowRenderer = this.props.rowRenderer!;\n    const customRowRendererProps = { ...otherProps, renderBaseRow: (p: RowRendererProps<R>) => <Row ref={ref} {...p} /> };\n\n    if (isElement(CustomRowRenderer)) {\n      if (CustomRowRenderer.type === Row) {\n        // In the case where Row is specified as the custom render, ensure the correct ref is passed\n        return <Row<R> {...props} />;\n      }\n      return React.cloneElement(CustomRowRenderer, customRowRendererProps);\n    }\n\n    return <CustomRowRenderer {...customRowRendererProps} />;\n  }\n\n  renderGroupRow(props: RendererProps<R>) {\n    const { ref, columns, ...rowGroupProps } = props;\n    const row = props.row as RowData;\n\n    return (\n      <RowGroup\n        {...rowGroupProps}\n        {...row.__metaData!}\n        columns={columns as CalculatedColumn<unknown>[]}\n        name={row.name!}\n        eventBus={this.props.eventBus}\n        renderer={this.props.rowGroupRenderer}\n        renderBaseRow={(p: RowRendererProps<R>) => <Row ref={ref} {...p} />}\n      />\n    );\n  }\n\n  renderRow(props: RendererProps<R>) {\n    const row = props.row as RowData;\n\n    if (row.__metaData && row.__metaData.getRowRenderer) {\n      return row.__metaData.getRowRenderer(this.props, props.idx);\n    }\n    if (row.__metaData && row.__metaData.isGroup) {\n      return this.renderGroupRow(props);\n    }\n\n    if (this.props.rowRenderer) {\n      return this.renderCustomRowRenderer(props);\n    }\n\n    return <Row<R> {...props} />;\n  }\n\n  renderPlaceholder(key: string, height: number) {\n    // just renders empty cells\n    // if we wanted to show gridlines, we'd need classes and position as with renderScrollingPlaceholder\n    return (\n      <div key={key} style={{ height }}>\n        {this.props.columns.map(column => <div style={{ width: column.width }} key={column.key as string} />)}\n      </div>\n    );\n  }\n\n  render() {\n    const { rowOverscanStartIdx, rowOverscanEndIdx, cellMetaData, columns, colOverscanStartIdx, colOverscanEndIdx, colVisibleStartIdx, colVisibleEndIdx, lastFrozenColumnIndex, rowHeight, rowsCount, totalColumnWidth, totalWidth, height, rowGetter, contextMenu } = this.props;\n    const RowsContainer = this.props.RowsContainer || RowsContainerDefault;\n\n    const rows = this.getRows(rowOverscanStartIdx, rowOverscanEndIdx)\n      .map(({ row, subRowDetails }, idx) => {\n        const rowIdx = rowOverscanStartIdx + idx;\n        return row && this.renderRow({\n          key: rowIdx,\n          ref: (row: (RowRenderer<R> & React.Component<RowRendererProps<R>>) | null) => {\n            if (row) {\n              this.rows.set(rowIdx, row);\n            } else {\n              this.rows.delete(rowIdx);\n            }\n          },\n          idx: rowIdx,\n          rowVisibleStartIdx: this.props.rowVisibleStartIdx,\n          rowVisibleEndIdx: this.props.rowVisibleEndIdx,\n          row,\n          height: rowHeight,\n          columns,\n          isSelected: this.isRowSelected(rowIdx, row),\n          cellMetaData,\n          subRowDetails,\n          colVisibleStartIdx,\n          colVisibleEndIdx,\n          colOverscanStartIdx,\n          colOverscanEndIdx,\n          lastFrozenColumnIndex,\n          isScrolling: this.props.isScrolling,\n          scrollLeft: this._scroll.scrollLeft\n        });\n      });\n\n    if (rowOverscanStartIdx > 0) {\n      rows.unshift(this.renderPlaceholder('top', rowOverscanStartIdx * rowHeight));\n    }\n\n    if (rowsCount - rowOverscanEndIdx > 0) {\n      rows.push(this.renderPlaceholder('bottom', (rowsCount - rowOverscanEndIdx) * rowHeight));\n    }\n\n    return (\n      <div\n        className=\"react-grid-Canvas\"\n        style={{ width: totalWidth, height }}\n        ref={this.canvas}\n        onScroll={this.handleScroll}\n      >\n        <InteractionMasks<R>\n          ref={this.interactionMasks}\n          rowGetter={rowGetter}\n          rowsCount={rowsCount}\n          rowHeight={rowHeight}\n          columns={columns}\n          rowVisibleStartIdx={this.props.rowVisibleStartIdx}\n          rowVisibleEndIdx={this.props.rowVisibleEndIdx}\n          colVisibleStartIdx={colVisibleStartIdx}\n          colVisibleEndIdx={colVisibleEndIdx}\n          enableCellSelect={this.props.enableCellSelect}\n          enableCellAutoFocus={this.props.enableCellAutoFocus}\n          cellNavigationMode={this.props.cellNavigationMode}\n          eventBus={this.props.eventBus}\n          contextMenu={this.props.contextMenu}\n          onHitBottomBoundary={this.onHitBottomCanvas}\n          onHitTopBoundary={this.onHitTopCanvas}\n          onHitLeftBoundary={this.handleHitColummBoundary}\n          onHitRightBoundary={this.handleHitColummBoundary}\n          scrollLeft={this._scroll.scrollLeft}\n          scrollTop={this._scroll.scrollTop}\n          getRowHeight={this.getRowHeight}\n          getRowTop={this.getRowTop}\n          getRowColumns={this.getRowColumns}\n          editorPortalTarget={this.props.editorPortalTarget}\n          {...this.props.interactionMasksMetaData}\n        />\n        <RowsContainer id={contextMenu ? contextMenu.props.id : 'rowsContainer'}>\n          <div style={{ width: totalColumnWidth }}>{rows}</div>\n        </RowsContainer>\n      </div>\n    );\n  }\n}\n"]}